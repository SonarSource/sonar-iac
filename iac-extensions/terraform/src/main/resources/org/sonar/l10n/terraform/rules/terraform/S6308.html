<p>Amazon Elasticsearch Service (ES) is a managed service to host Elasticsearch instances. ES domains can be encrypted if the Elasticsearch version is
5.1 or above, ensuring the security of data-at-rest. If the encryption is enabled indices, logs, swap files, data in the application directory, and
automated snapshots are stored encrypted. In the case that adversaries gain physical access to the storage medium they are not able to access the
data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The database contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Itâ€™s recommended to encrypt Elasticsearch domains that contain sensitive information. Encryption and decryption are handled transparently by ES, so
no further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain">aws_elasticsearch_domain</a>:</p>
<pre>
resource "aws_elasticsearch_domain" "elasticsearch" {
  encrypt_at_rest {
    enabled = false  # Sensitive, disabled by default
  }
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain">aws_elasticsearch_domain</a>:</p>
<pre>
resource "aws_elasticsearch_domain" "elasticsearch" {
  encrypt_at_rest {
    enabled = true
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/encryption-at-rest.html">Encryption of data at rest for Amazon
  Elasticsearch Service</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311.html">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>


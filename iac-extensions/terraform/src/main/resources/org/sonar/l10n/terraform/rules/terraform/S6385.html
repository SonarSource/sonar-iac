<h2>Why is this an issue?</h2>
<p>Defining a custom role for a Subscription or a Management group that allows all actions will give them the same
  capabilities as the built-in Owner
  role. It’s recommended to limit the number of subscription owners in order to mitigate the risk of being breached by a
  compromised owner.</p>
<p>This rule raises an issue when a custom role has an assignable scope set to a Subscription or a Management Group and
  allows all actions
  (<code>*</code>) ¨</p>
<h2>How to fix it</h2>
<h3>Code examples</h3>
<h4>Noncompliant code example</h4>
<pre>
resource "azurerm_role_definition" "example" { # Sensitive
  name        = "example"
  scope       = data.azurerm_subscription.primary.id

  permissions {
    actions     = ["*"]
    not_actions = []
  }

  assignable_scopes = [
    data.azurerm_subscription.primary.id
  ]
}
</pre>
<h4>Compliant solution</h4>
<pre>
resource "azurerm_role_definition" "example" {
  name        = "example"
  scope       = data.azurerm_subscription.primary.id

  permissions {
    actions     = ["Microsoft.Compute/*"]
    not_actions = []
  }

  assignable_scopes = [
    data.azurerm_subscription.primary.id
  ]
}
</pre>
<h2>Resources</h2>
<h3>Documentation</h3>
<ul>
  <li><a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken
    Access Control
  </li>
  <li><a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design
  </li>
  <li><a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html">OWASP Top 10 2017 Category
    A5</a> - Broken Access
    Control
  </li>
  <li><a href="https://cwe.mitre.org/data/definitions/266">MITRE, CWE-266</a> - Incorrect Privilege Assignment</li>
  <li><a href="https://docs.microsoft.com/en-us/azure/role-based-access-control/custom-roles">Azure Documentation</a> -
    Azure custom roles
  </li>
  <li><a href="https://docs.microsoft.com/en-us/azure/role-based-access-control/best-practices">Azure Documentation</a>
    - Best practices for Azure
    RBAC
  </li>
</ul>


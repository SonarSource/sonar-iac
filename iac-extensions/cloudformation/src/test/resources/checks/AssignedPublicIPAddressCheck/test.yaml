AWSTemplateFormatVersion: 2010-09-09
Resources:
  NonCompliantDMSReplicationInstance:
    Type: AWS::DMS::ReplicationInstance # Noncompliant {{Make sure that using public IP address is safe here.}}
    #     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  NonCompliantDMSReplicationInstance1:
    Type: AWS::DMS::ReplicationInstance
    #     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^> {{Related DMS instance}}
    Properties:
      PubliclyAccessible: true # Noncompliant {{Make sure that using public IP address is safe here.}}
    #                     ^^^^

  CompliantDMSReplicationInstance:
    Type: AWS::DMS::ReplicationInstance
    Properties:
      PubliclyAccessible: false

  NonCompliantEC2Instance:
    Type: AWS::EC2::Instance # Noncompliant {{Make sure that using public IP address is safe here.}}
    #     ^^^^^^^^^^^^^^^^^^

  NonCompliantEC2Instance1:
    Type: AWS::EC2::Instance
    #     ^^^^^^^^^^^^^^^^^^> {{Related EC2 instance}}
    Properties:
      NetworkInterfaces: # Noncompliant {{Make sure that using public IP address is safe here.}}
    # ^^^^^^^^^^^^^^^^^
        - DeviceIndex: "0"

  NonCompliantEC2Instance2:
    Type: AWS::EC2::Instance
    #     ^^^^^^^^^^^^^^^^^^> {{Related EC2 instance}}
    Properties:
      NetworkInterfaces: # Noncompliant {{Make sure that using public IP address is safe here.}}
    # ^^^^^^^^^^^^^^^^^
        AssociatePublicIpAddress: false
    # NetworkInterfaces expects a sequence, not a mapping

  NonCompliantEC2Instance3:
    Type: AWS::EC2::Instance
    #     ^^^^^^^^^^^^^^^^^^> {{Related EC2 instance}}
    Properties:
      NetworkInterfaces:
        - AssociatePublicIpAddress: true # Noncompliant {{Make sure that using public IP address is safe here.}}
    #                               ^^^^

  CompliantEC2Instance:
    Type: AWS::EC2::Instance
    Properties:
      NetworkInterfaces:
        - AssociatePublicIpAddress: false

  NonCompliantEC2LaunchTemplate:
    Type: AWS::EC2::LaunchTemplate # Noncompliant {{Make sure that using public IP address is safe here.}}
    #     ^^^^^^^^^^^^^^^^^^^^^^^^

  NonCompliantEC2LaunchTemplate1:
    Type: AWS::EC2::LaunchTemplate
    #     ^^^^^^^^^^^^^^^^^^^^^^^^> {{Related EC2 template}}
    Properties:
      LaunchTemplateData: # Noncompliant {{Make sure that using public IP address is safe here.}}
    # ^^^^^^^^^^^^^^^^^^
        InstanceType: t2.micro



  NonCompliantEC2LaunchTemplate3:
    Type: AWS::EC2::LaunchTemplate
    #     ^^^^^^^^^^^^^^^^^^^^^^^^> {{Related EC2 template}}
    Properties:
      LaunchTemplateData:
        NetworkInterfaces: # Noncompliant {{Make sure that using public IP address is safe here.}}
    #   ^^^^^^^^^^^^^^^^^
          AssociatePublicIpAddress: false
    # NetworkInterfaces expects a sequence, not a mapping

  NonCompliantEC2LaunchTemplate4:
    Type: AWS::EC2::LaunchTemplate
    #     ^^^^^^^^^^^^^^^^^^^^^^^^> {{Related EC2 template}}
    Properties:
      LaunchTemplateData:
        NetworkInterfaces:
        - AssociatePublicIpAddress: true # Noncompliant {{Make sure that using public IP address is safe here.}}
      #                             ^^^^

  CompliantEC2LaunchTemplate:
    Type: AWS::EC2::LaunchTemplate
    Properties:
      LaunchTemplateData:
        NetworkInterfaces:
        - AssociatePublicIpAddress: false

  NonSensitiveResource:
    Type: Some::Other::Type

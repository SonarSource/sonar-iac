AWSTemplateFormatVersion: '2010-09-09'
Resources:
  WeakSecurityPolicyV1:
    Type: AWS::ApiGateway::DomainName
    Properties:
      SecurityPolicy: "TLS_1_0"  # Noncompliant {{Change this configuration to use a stronger protocol.}}
      #               ^^^^^^^^^

  NoSecurityPolicyV1:
    Type: AWS::ApiGateway::DomainName # Noncompliant {{Omitting SecurityPolicy disables traffic encryption.}}
    #     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    Properties:
      Foo: Bar

  StrongSecurityPolicyV1:
    Type: AWS::ApiGateway::DomainName
    Properties:
      SecurityPolicy: "TLS_1_2"

  WeakSecurityPolicyV2:
    Type: AWS::ApiGatewayV2::DomainName
    Properties:
      DomainNameConfigurations:
        - "foo"
        - Bar: "bar"
        - SecurityPolicy: "TLS_1_0"  # Noncompliant {{Change this configuration to use a stronger protocol.}}
          #               ^^^^^^^^^

  NoSecurityPolicyV2:
    Type: AWS::ApiGatewayV2::DomainName
    Properties:
      DomainNameConfigurations: # Noncompliant {{Omitting SecurityPolicy disables traffic encryption.}}
    # ^^^^^^^^^^^^^^^^^^^^^^^^
        Foo: Bar

  DomainNameConfiguration:
    Type: AWS::ApiGatewayV2::DomainName # Noncompliant {{Omitting DomainNameConfigurations.SecurityPolicy disables traffic encryption.}}
    #     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    Properties:
      Foo: Bar

  StrongSecurityPolicyV2:
    Type: AWS::ApiGatewayV2::DomainName
    Properties:
      DomainNameConfigurations:
        - SecurityPolicy: "TLS_1_2"

  ElasticNoOptions:
    Type: 'AWS::Elasticsearch::Domain' # Noncompliant {{Omitting DomainEndpointOptions.TLSSecurityPolicy disables traffic encryption.}}

  ElasticWeakPolicy:
    Type: 'AWS::Elasticsearch::Domain'
    Properties:
      DomainEndpointOptions:
        TLSSecurityPolicy: "Policy-Min-TLS-1-0-2019-07"  # Noncompliant

  ElasticNoPolicy:
    Type: 'AWS::Elasticsearch::Domain'
    Properties:
      DomainEndpointOptions: # Noncompliant {{Omitting TLSSecurityPolicy disables traffic encryption.}}
        Foo: Bar

  ElasticStrongPolicy:
    Type: 'AWS::Elasticsearch::Domain'
    Properties:
      DomainEndpointOptions:
        TLSSecurityPolicy: "Policy-Min-TLS-1-2-2019-07"

  OpenSearchNoOptions:
    Type: 'AWS::OpenSearchService::Domain' # Noncompliant {{Omitting DomainEndpointOptions.TLSSecurityPolicy disables traffic encryption.}}

  OpenSearchWeakPolicy:
    Type: 'AWS::OpenSearchService::Domain'
    Properties:
      DomainEndpointOptions:
        TLSSecurityPolicy: "Policy-Min-TLS-1-0-2019-07"  # Noncompliant

  OpenSearchNoPolicy:
    Type: 'AWS::OpenSearchService::Domain'
    Properties:
      DomainEndpointOptions: # Noncompliant {{Omitting TLSSecurityPolicy disables traffic encryption.}}
        Foo: Bar

  OpenSearchStrongPolicy:
    Type: 'AWS::OpenSearchService::Domain'
    Properties:
      DomainEndpointOptions:
        TLSSecurityPolicy: "Policy-Min-TLS-1-2-2019-07"

  NoApiGateWay:
    Type: 'Something else'
    Properties:
      SecurityPolicy: "TLS_1_0"

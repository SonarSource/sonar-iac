apiVersion: v1
kind: Deployment
metadata:
  name: app
spec:
  containers:
    - name: waiter
      image: "alpine:latest"
      command: ["/bin/sleep","9000"]
      env:
        ## Non compliant use cases
        - name: my-secret
          #     ^^^^^^^^^> {{"secret" detected here}}
          value: "47828a8dd77ee1eb9dde2d5e93cb221ce8c32b37" # Noncompliant {{Make sure this is not a hard-coded secret.}}
          #      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

        - name: MY_SECRET_2
          #     ^^^^^^^^^^^> {{"SECRET" detected here}}
          value: "47828a8dd77ee1eb9dde2d5e93cb221ce8c32b37" # Noncompliant {{Make sure this is not a hard-coded secret.}}
          #      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

        - name: number-secret
          value: 346703408134761340194738149 # Noncompliant

        - name: super-api-key
          value: "47828a8dd77ee1eb9dde2d5e93cb221ce8c32b37" # Noncompliant

        - name: token
          value: "47828a8dd77ee1eb9dde2d5e93cb221ce8c32b37" # Noncompliant

        - name: authentication
          value: "47828a8dd77ee1eb9dde2d5e93cb221ce8c32b37" # Noncompliant

        - name: authorization
          value: "47828a8dd77ee1eb9dde2d5e93cb221ce8c32b37" # Noncompliant

        - name: your-credentials
          value: "47828a8dd77ee1eb9dde2d5e93cb221ce8c32b37" # Noncompliant

        ### Compliant Examples
        - name: non-sensitive-name
          value: "not a secret"

        - name: low-entropy-secret
          value: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"

        - name: low-entropy-secret2
          value: "aaaaabbbbbbcccccccc"

        - name: low-entropy-secret3
          value: "abcabcabcabacbacbac"

        - name: human-readable-secret
          value: "thisisnotanhardcodedthingitsclearlytext"

        - name: secret-key
          value:
            another-key: "47828a8dd77ee1eb9dde2d5e93cb221ce8c32b37"

        - name : GH_TOKEN
          value: "${{ secrets.GH_TOKEN }}"

        - name: env-secret
          value: "${SECRET}"

        - name: env-secret2
          value: "$SECRET"

        - name: placeholder-api-key1
          value: <your-api-key>

        - name: placeholder-api-key2
          value: <%= ENV["SECRET_KEY_BASE"] %>

        - name: placeholder-api-key3
          value: "{{ api_token }}"

        - name: encrypted-secret
          value: ENC[AES256_GCM,data:5qDN8dD9XizLyBqDgm1EFzuI8tgUbD4pMmt3DaI3rqKSb8MtMSZmzJGomDk=,iv:o0IK0eTOhlbQPw91gDvJ2bD1Dry26mJFqnUehpJ3rWQ=,tag:BwN/pDYWVVca09c3l/lsgg==,type:str]

        - name: vault.hashicorp.com/agent-inject-secret-hmac
          value: cmsweb/data/cmsamqproxy-secrets

        - name: authorize
          value: ~/.ssh/id_rsa.pub

        - name: node.session.auth.username
          value: dXNlcm5hbWU=

        - name: node.session.auth.password
          value: cGFzc3dvcmQ= # Raised by S2068

        - name: APCA_API_KEY_ID
          value: 'YOUR_APCA_API_KEY_ID'

        - name: empty-secret
          value: ""

        - name: blank-secret
          value: "            "

        - name: null-secret
          value: null

        - name: null-secret2
          value: NULL

        - name: null-secret3
          value: Null

        - name: null-secret4
          value: ~

        - name: null-secret5
          value:

        - name: bool-secret1
          value: true
        - name: bool-secret2
          value: false
        - name: bool-secret3
          value: TRUE
        - name: bool-secret4
          value: FALSE
        - name: bool-secret5
          value: True
        - name: bool-secret6
          value: False
  template:
    spec:
      containers:
        - name: waiter
          image: "alpine:latest"
          command: ["/bin/sleep","9000"]
          env:
            - name: my-secret
              value: "47828a8dd77ee1eb9dde2d5e93cb221ce8c32b37" # Noncompliant

apiVersion: v1
kind: Deployment
metadata:
  name: app
spec:
  containers:
    - name: waiter
      image: "alpine:latest"
      command: ["/bin/sleep","9000"]
      env:
        ## Non compliant use cases
        - name: password
          #     ^^^^^^^^> {{"password" detected here}}
          value: a3gd54hw6a53gds3ha3we5r43h51trg1asf2sdf54g65sd4fg54dfg # Noncompliant{{Make sure this is not a hard-coded credential.}}
          #      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        - name: my_super_password
          #     ^^^^^^^^^^^^^^^^^> {{"password" detected here}}
          value: a3gd54hw6a53gds3ha3we5r43h51trg1asf2sdf54g65sd4fg54dfg # Noncompliant{{Make sure this is not a hard-coded credential.}}
          #      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        - name: PASSWORD
          value: a3gd54hw6a53gds3ha3we5r43h51trg1asf2sdf54g65sd4fg54dfg # Noncompliant
        - name: my_pwd
          value: a3gd54hw6a53gds3ha3we5r43h51trg1asf2sdf54g65sd4fg54dfg # Noncompliant
        - name: my_pwd
          value: a1b2c3d4 # Noncompliant
        - value: a3gd54hw6a53gds3ha3we5r43h51trg1asf2sdf54g65sd4fg54dfg # Noncompliant
          #      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
          name: my_pwd
          #     ^^^^^^< {{"pwd" detected here}}
        - name: pwd1
          value: a1b2c3d4 # Noncompliant
        - name: pwd_password
          value: a1b2c3d4 # Noncompliant
        - name: password
          value: pwd1234 # Noncompliant
        - name: PASSWORD
          randomstuff: azerty
          value: a3gd54hw6a53gds3ha3we5r43h51trg1asf2sdf54g65sd4fg54dfg # Noncompliant
        - name: my_pwd
          value: pwd1234 # Noncompliant

        ## Compliant use cases
        # Structure is not validated
        - name: something_else
          value: a3gd54hw6a53gds3ha3we5r43h51trg1asf2sdf54g65sd4fg54dfg
        - key: my_pwd
          value: a3gd54hw6a53gds3ha3we5r43h51trg1asf2sdf54g65sd4fg54dfg
        - other_name: my_pwd
          value: a3gd54hw6a53gds3ha3we5r43h51trg1asf2sdf54g65sd4fg54dfg
        - name: my_pwd
          other_value: a3gd54hw6a53gds3ha3we5r43h51trg1asf2sdf54g65sd4fg54dfg
        - value: a3gd54hw6a53gds3ha3we5r43h51trg1asf2sdf54g65sd4fg54dfg
        - name: my_pwd
          value:
            unexpected: object
        - ? - item1
          : my_pwd
          value: a3gd54hw6a53gds3ha3we5r43h51trg1asf2sdf54g65sd4fg54dfg

        # placeholder
        - name: this_is_the_pwd
          value: this_is_the_pwd

        - name: pwd
          value: pwd1234

        # excluded specific values
        - name: pwd
          value: null
        - name: pwd
          value: true
        - name: pwd
          value: false
        - name: pwd
          value: your info
        - name: pass
          value: password
        - name: password
          value: ""

        # repetitions
        - name: pwd
          value: aaaaainfo
        - name: pwd
          value: aaaaaaaaaaaaaaaaaaaaaa

        # variable interpolation
        - name: pwd
          value: ${my_var}
        - name: pwd
          value: ((my_var))
        - name: pwd
          value: $my_var
        - name: pwd
          value: {my_var}

        # Shell command substitution
        - name: pwd
          value: $(some command)

        # Environment variable access in various languages
        - name: pwd
          value: System.getenv("info")
        - name: pwd
          value: os.Getenv("info")
        - name: pwd
          value: ENV['info']

        # Angle-bracketed placeholders
        - name: pwd
          value: <info>

        # Versions look-alike strings
        - name: pwd
          value: v1.0
        - name: pwd
          value: 2.3.4
        - name: pwd
          value: v1.2.3-alpha

        # Encrypted string
        - name: pwd
          value: ENC(a3gd54hw6a53gds3ha3we5r43h51trg1asf2sdf54g65sd4fg54dfg)
        - name: pwd
          value: ENC{a3gd54hw6a53gds3ha3we5r43h51trg1asf2sdf54g65sd4fg54dfg}
        - name: pwd
          value: ENC[a3gd54hw6a53gds3ha3we5r43h51trg1asf2sdf54g65sd4fg54dfg]

        # Doesn't validate the inclusion pattern
        - name: pwd
          value: short
        - name: pwd
          value: 個人電郵不能是空白
        - name: pwd
          value:

      other_place:
        - name: password
          value: a3gd54hw6a53gds3ha3we5r43h51trg1asf2sdf54g65sd4fg54dfg
  template:
    spec:
      containers:
        - name: waiter
          image: "alpine:latest"
          command: ["/bin/sleep","9000"]
          env:
            - name: password
              value: a3gd54hw6a53gds3ha3we5r43h51trg1asf2sdf54g65sd4fg54dfg # Noncompliant


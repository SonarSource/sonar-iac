apiVersion: v1
kind: Pod
metadata:
  name: example-storage-limit
spec:
  containers:
    - name: {{ .Values.container.name }} # Noncompliant
      image: nginx
      resources:
        # The check expect "request" to be specified here, so the container is Non-compliant
        limits:
          ephemeral-storage: {{ .Values.container.storage.limit }}
---
apiVersion: v1
kind: Pod
metadata:
  name: example-no-resources
spec:
  containers:
    - name: {{ .Values.container.name }} # Noncompliant
      image: nginx
      # Missing resources
---
apiVersion: v1
kind: Pod
metadata:
  name: example-compliant
spec:
  containers:
    - name: {{ .Values.container.name }} # Compliant
      image: nginx
      resources:
        requests:
          ephemeral-storage: {{ .Values.container.storage.request }}

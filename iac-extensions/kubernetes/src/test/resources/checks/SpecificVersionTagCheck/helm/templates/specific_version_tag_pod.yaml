apiVersion: v1
kind: Pod
metadata:
  name: example
  namespace: example-namespace
spec:
  containers:
    - name: compliant_with_fixed_tag
      image: {{ .Values.imageWithTag }}
    - name: compliant_with_fixed_sha
      image: {{ .Values.imageWithSha }}
    - name: compliant_with_fixed_tag_2
      image: {{ .Values.complexImageWithTag }}

    - name: non_compliant_without_tag
      # Noncompliant@+1
      image: {{ .Values.pureImageName }}
#               ^^^^^^^^^^^^^^^^^^^^^
    - name: non_compliant_with_latest_tag
      # Noncompliant@+1
      image: {{ .Values.imageWithLatestTag }}
#               ^^^^^^^^^^^^^^^^^^^^^^^^^^
    - name: non_compliant_split_image
      # Noncompliant@+1
      image: "{{ .Values.pureImageName }}:{{ .Values.latestTag }}"
#                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

    - name: non_compliant_split_image_with_unresolved_image_name
      # Noncompliant@+1
      image: "{{ .Values.unresolvedImageName }}:latest"

    - name: compliant_split_image
      image: {{ .Values.pureImageName }}:{{ .Values.specifiedTag }}

    - name: compliant_unresolved_image
      image: {{ .Values.unresolvedImage }}

    - name: compliant_unresolved_tag
      image: "nginx:{{ .Values.unresolvedTag }}"

    - name: compliant_unresolved_image_name
      image: "{{ .Values.unresolvedImageName }}:1.14.2"

    - name: compliant_unresolved_split_image
      image: "{{ .Values.unresolvedImageName }}:{{ .Values.unresolvedTag }}"
